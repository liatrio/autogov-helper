{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "_type": {
      "type": "string",
      "const": "https://in-toto.io/Statement/v1"
    },
    "subject": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "digest": {
            "type": "object",
            "properties": {
              "sha256": { "type": "string" }
            },
            "required": ["sha256"]
          }
        },
        "required": ["name", "digest"]
      }
    },
    "predicateType": {
      "type": "string",
      "const": "https://in-toto.io/attestation/vulns/v0.2"
    },
    "predicate": {
      "type": "object",
      "properties": {
        "scanner": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "uri": { "type": "string" },
            "version": { "type": "string" },
            "db": {
              "type": "object",
              "properties": {
                "uri": { "type": "string" },
                "version": { "type": "string" },
                "lastUpdate": { "type": "string", "format": "date-time" }
              },
              "required": ["uri", "version", "lastUpdate"]
            },
            "result": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "id": { "type": "string" },
                  "severity": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "method": { "type": "string" },
                        "score": { "type": "string" }
                      },
                      "required": ["method", "score"]
                    }
                  }
                },
                "required": ["id", "severity"]
              }
            }
          },
          "required": ["name", "uri", "version", "db", "result"]
        }
      },
      "required": ["scanner"]
    }
  },
  "required": ["_type", "subject", "predicateType", "predicate"]
} 